<dom-module id="app-main">
	<script src="../bower_components/firebase/firebase.js">
  </script>
  <link rel="import" href="navbar.html">
  <link rel="import" href="post.html">
  <link rel="import" href="newpost.html">
	<template>
		<app-navbar></app-navbar>
		<div class="container">
			<template
					is="dom-repeat" items="{{ posts }}"
					observe="title content date">
				<app-post
						title="{{ item.title }}"
						content="{{ item.content }}"
						date="[[ item.date ]]">
				</app-post>
			</template>
			<app-newpost></app-newpost>
	</template>
	<script>
		Polymer({
			is: 'app-main',
			ready: function() {
				var self = this;
				this.posts = [];
				this.fb = new Firebase(
					'https://etherealmachine.firebaseio.com/posts');
				this.fb.on('value', function(snapshot) {
					var posts = [];
					var val = snapshot.val();
					for (var id in val) {
						var post = val[id];
						post.id = id;
						posts.push(post);
					}
					self.set('posts', posts);
				});
			},
		});
	</script>
</dom-module>