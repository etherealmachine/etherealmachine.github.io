<dom-module id="app-newpost">
	<script src="../bower_components/firebase/firebase.js">
  </script>
	<template>
		<form>
			<div class="form-group">
				<input
						name="title"
						type="text"
						class="form-control"
						placeholder="Title" />
			</div>
			<div class="form-group">
				<textarea
						name="content"
						class="form-control"
						rows="15"
						placeholder="Some awesome content."></textarea>
			</div>
			<div class="form-group">
				<input
						name="tagString"
						type="text"
						class="form-control"
						placeholder="space separated tags" />
			</div>
			<div class="form-group">
				<button 
						type="submit"
						class="btn btn-primary"
						on-click="save">
					Save
				</button>
			</div>
		</form>
	</template>
	<script>
		Polymer({
			is: 'app-newpost',
			ready: function() {
				this.fb = new Firebase('https://etherealmachine.firebaseio.com/posts');
			},
	    toTagSet: function(tagString) {
	    	var tags = tagString.split(' ');
	    	var tagSet = {};
	    	for (var i = 0; i < tags.length; i++) {
	    		tagSet[tags[i]] = true;
	    	}
	    	return tagSet;
	    },
			save: function(e) {
				e.preventDefault();
	    	var form = FormValues(e);
				this.fb.push({
					title: form['title'],
					content: form['content'],
					tags: this.toTagSet(form['tagString']),
					date: Date.now()
				});
				this.querySelector('form').reset();
			}
		});
	</script>
</dom-module>
